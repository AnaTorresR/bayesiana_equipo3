---
title: "Modelos Lineales Generalizados"
subtitle: "⚔ Capítulo 18 ⚔<br/>"
author: 
  - Iván Oswaldo Salgado Velázquez
  - Aide Jazmín González Cruz
  - Ana Eréndira Torres Ramírez
  - Victor Erasto
  - Oscar Arturo Bringas López
institute: "ITAM"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: center, middle

<div style="text-align: justify">

```{r setup, echo=FALSE}
#options(htmltools.dir.version = FALSE)

library(xaringanExtra)

xaringanExtra::use_logo(
  image_url = "http://escolar.itam.mx/centro_tesis/img/logo-ITAM.png",
  position = xaringanExtra::css_position(top = "1em", right = "1em")
)

xaringanExtra::use_broadcast()

xaringanExtra::use_panelset()
xaringanExtra::style_panelset_tabs(
  active_foreground = "#061b94",
  hover_foreground = "#000000",
  font_family = "Roboto"
)
```

# Objetivo

El objetivo de este capítulo es conocer las principales definiciones y problemáticas asociados a los diseños de experimentos que pretenden inferir el efecto asociado a un tratamiento o exposición aplicado a un individuo. 

A lo largo del capítulo se analizan diferentes problemas junto con sus respectivas hipótesis y propuestas de solución.

---
class: inverse, center, middle

# Capítulo 18.1

---
class: inverse, center, middle

# Capítulo 18.2

## Efectos Causales Promedio

---

## Efectos causales promedio

<div style="text-align: justify">

El contra-factual o resultado potencial añade claridad al significado de efectos causales, pero también resalta el desafío inherente en su estimación. 

En experimentos en la cuales solo un tratamiento es aplicado a cada individuo, no será posible estimar el efecto causal a **nivel individuo**, $y^1_i − y^0_i$.

```{r, fig.align='center', out.height='300', out.width='600', echo=F}
knitr::include_graphics("img/red_and_blue_pill.jpeg")
```

---
## ¿Qué hacemos?

Supongamos que los individuos pueden aplicar a ambos estudios tratamiento y 
control, es decir, se tiene $y^1_i, y^0_i$ para cada individuo. 

Dados estos dos resultados potenciales se puede obtener el efecto del tratamiento 
de cada individuo.

$$\tau_i = y^1_i − y^0_i$$
**Por ejemplo:**

.pull-left[
```{r, fig.align='center', out.height='150', out.width='500', echo=F}
knitr::include_graphics("img/ejemplo.png")
```
]
.pull-right[

Existen diferencias entre los grupos de tratamiento y de control por lo que se 
deben de realizar ciertos ajustes para estimar el efecto causal. 
 
El efecto causal $\tau_i$ puede variar de persona en persona; es por eso que el
cálculo de éste dependerá de que grupo de personas se está promediando este
efecto.
]

---

## Efectos medios del tratamiento 

.panelset[
.panel[.panel-name[SATE]

#### Sample Average Treatment Effect

Este estimado, llamado **Efecto promedio de tratamiento muestra** o SATE, puede ser calculado al promediar todos los $y_i^1$ y sustraer el promedio de los $y^0_i$ en al muestra. Equivalentemente y quizá más intuitivamente, podemos simplemente promediar los efectos causales a nivel individual.

$$\tau_{SATE}=\frac{1}{n} \sum_{i=1}^n(y_i^1 - y_i^0)$$
```{r, fig.align='center', out.height='150', out.width='300', echo=F}
knitr::include_graphics("img/sample.png")
```

]

.panel[.panel-name[CATE]

#### Conditional Average Treatment Effect

Este estimador se calcula para subconjuntos definidos de la muesta, por ejemplo, 
por edad, por género, etc. 

Estos estimadores condicionales pueden tomar formas complicadas como las
predicciones de los modelos de regresión lineal.

```{r, fig.align='center', out.height='250', out.width='400', echo=F}
knitr::include_graphics("img/groups.jpeg")
```

]

.panel[.panel-name[PATE]

#### Population Average Treatment Effect

<div style="text-align: justify">

El efecto de tratamiento promedio de tratamiento popular es a menudo una meta en la inferencia causal. Para una población de tamaño N, podemos definir el *PATE* como:

$$\tau_{PATE} = \frac{1}{N} \sum_{i=1}^n(y_i^1 - y_i^0)$$
En este problema de inferencia, hay dos tipos de datos faltantes:

1. Los valores contractuales faltantes dentro de nuestra muestra
2. Ambos resultados potenciales para aquellas observaciones que no están en la muestra.

]
]

???

Los investigadores a menudo quieren inferir acerca de alguna población de interés en vez de simplemente estudiar una muestra. Realísticamente, las personas que forman parte de un experimento social o médico no son obtenidos de manera aleatoria o representativa de una población.

Mientras mejor esté hecha la muestra para hacer inferencias causales, esta se vuelve menos representativa de la población conocida.

Para conocer el PATE, nuestra omnisciencia necesitaría extenderse para ver ambos resultados potenciales de la completa población de interés

---

#### Population Average Treatment Effect

<div style="text-align: justify">

Si la muestra de estudio es aleatoria entonces cualquier estimador insesgado de 
**SATE** será estimador insesgado de **PATE**. Más aún, cuando se ajustan modelos 
de regresión, el estimador **PATE** dependerá de la distribución asumida de los 
predictores en la población de interés.

Por ejemplo, si el efecto del tratamiento estimado es mayor para las mujeres que 
para los hombres entonces el estimador **PATE** dependerá de la proporción de 
hombres y mujeres de la población de interés. 

Si la muestra no es aleatoria, estimar **PATE** requiere un modelo del efecto del 
tratamiento dados los predictores previos al tratamiento que nos permitan extrapolar
de unidades experimentales a la población general. 

---

### Problemas de autoselección en grupos de tratamiento.

<div style="text-align: justify">

Aunque se tengan la misma cantidad de hombres y mujeres en ambos
grupos, los individuos que se encuentran en el grupo de control son más jóvenes que 
los individuos que se encuentran en el grupo de tratamiento. Esta inferencia de
edad se debe tomar en cuenta debido a que la edad también influye en el resultado. 

Los resultados potenciales encapsulan toda la información necesaria con respecto a lo que necesitamos para que ésta información sea similar en ambos grupos.
Dado que no podemos ajustar los datos directamente, utilizamos nuestras variables de pre entratamiento como una sustitutos. 

```{r, fig.align='center', out.height='250', out.width='400', echo=F}
knitr::include_graphics("img/age-groups2.jpeg")
```

---

### Como abordar el desbalance entre los grupos de tratamiento y control

<div style="text-align: justify">

Existen enfoque estadísticos que nos ayudan a asegurar el balance entre los grupos 
de control y tratamiento. 

* **Etapa de diseño:** Se utiliza **aleatorización** para asegurar balance entre ambos grupos. Y se utiliza el **bloqueo** para reducir la variación en cualquier desbalance. 

* **Etapa de análisis:** Se pueden **ajustar** para que las variables previas al tratamiento corrijan las diferencias entre los dos grupos para reducir sesgos en la estimación. 

```{r, fig.align='center', out.height='250', out.width='400', echo=F}
knitr::include_graphics("img/random_assign.png")
```

---
class: inverse, center, middle



# Capítulo 18.3

---
class: inverse, center, middle

# Capítulo 18.4

---





